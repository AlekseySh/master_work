\section{Постановка задачи}


\indent
\indent
Настоящая работа посвящена разработке интеллектуальной системы, 
подсказывающей пользователям социальных сетей 
релевантные популярные хэштеги к загружаемым ими изображениям.


\indent
\indent
В течение нескольких последних лет
задача тегирования изображений в различных вариациях уже становилась
предметом исследований. Например, в 2015 году сотрудники
\textit{Facebook AI Research} опубликовали статью
\cite{hashtags_facebook2015}, где предложили способ
предсказывать пользовательские
хэштеги к фотографиям, основываясь и на содержании 
изображений, и на информации о том, как пользователь подписывал
свои предыдущие публикации. Обучение и проверка модели были 
произведены на собранном в социальной сети
\textit{Facebook}\footnote{www.facebook.com}
датасете \footnote{\textit{Датасет} -- это некоторый размеченный набор данных,
например, множество пар изображений и соответствующих им классов}.
Он включал в себя 20 млн. изображений, каждое из которых было
аннотировано одним из 4.6 млн. тегов. Спустя 2 года,
в 2017-м году, исследователи
из того же \textit{Facebook AI Research} опубликовали 
новую работу \cite{hashtags_facebook2017},
в которой усовершенствовали свой подход,
использующий историю активности пользователя. На этот раз
в качестве датасета использовался 
\textit{YFCC100M}\footnote{Yahoo Flickr Creative Commons 100 Million Dataset}
\cite{yfcc100m},
состоящий из медиафайлов, загруженных пользователями на ресурс
\textit{flickr}\footnote{www.flickr.com}. 
Набор данных \textit{YFCC100M} оказался ещё больше предыдущего:
он содержит 100 млн. файлов, из которых 70\% -- фотографии, аннотированные
ключевыми словами. Примерно в то же время, в 2016 году, был представлен 
датасет более скромного размера -- \textit{HARRISON},
содержащий 60 тыс. изображений  и 250 тыс. хэштегов из социальной сети 
\textit{Instagram}\footnote{www.instagram.com}. Авторы описали его
в статье \cite{harrison}, где привели результаты
собственных экспериментов, произведенных на этом 
наборе данных.


\indent
\indent
В данной работе задача ставится следующим образом: для загружаемой 
пользователем фотографии необходимо предложить популярный тег,
имеющий отношение к содержанию изображения. Мы будем работать
только с популярными тегами по двум причинам.
Во-первых, они полезны в 
случаях, когда пользователь хочет, чтобы его публикацию увидело как можно
больше людей. При этом он может не знать, какие популярные в данный момент
теги было бы уместно поставить. 
Во-вторых, использование только популярных тегов 
позволит ограничиться датасетом относительно небольшого размера. 
Это важно, так как в распоряжении автора относительно скромные вычислительные
ресурсы (по сравнению с теми, которые необходимы для воспроизведения
результатов экспериментов на миллионах изображений из работ
\cite{hashtags_facebook2015} и \cite{hashtags_facebook2017}, упомянутых выше).


\indent
\indent
Говоря о популярных хэштегах в социальных сетях можно выделить две 
их разновидности.
Первые являются выражением чувств, эмоций и других абстрактных понятий.
Например, в описанном ранее наборе данных \textit{HARRISON} 
действительно много тегов такого вида, перечислим некоторые из них: 
\htag{love} (самый часто встречающийся), \htag{friendship}, \htag{happy},
\htag{bored} и подобные.

\indent
\indent
Вторые непосредственно
связаны с физическими объектами, находящимися в кадре, например  
\htag{sport}, \htag{cafe}, \htag{nature}. 
Интуитивно понятно, что если обучить предсказательную систему,
построенную на машинном зрении, только на таких тегах, то
её точность будет выше, чем у системы, которой приходилось бы угадывать
абстрактные понятия. Чтобы обучать систему таким образом
нужен подходящий набор обучающих данных, но существующие датасеты, 
собранные из социальных сетей, не разделяют тренировочные примеры на те, 
где визуальный контент напрямую связан с целевыми классами, и те, где это не так.
В связи с чем возникла идея 
адаптировать датасет, изначально не предназначавшийся для предсказания
тегов, но содержащий аннотации, связанные с объектами
в кадре. Кроме того, датасет должен быть относительно небольшим,
чтобы не требовать значительных 
вычислительных ресурсов, но при этом достаточно разнообразным, чтобы 
быть релевантным как можно большему количеству загружаемого контента.
В итоге был выбран датасет сцен и локаций 
\textit{SUN\cite{sundata} (Scene Understanding Dataset)}, 
разметка которого после некоторой обработки была
связана с популярными хэштегами.

\indent
\indent  
\textit{SUN} -- это набор фотографий, для каждой из которых выбрано одно
 из четырехсот названий локаций (сцен), вот несколько примеров:
  
  
\begin{itemize}
    \item \textit{baseball field}
    \item \textit{basketball court}
    \item \textit{ice shelf}
    \item \textit{forest}
    \item \textit{wind farm}
\end{itemize}


\indent
\indent
Большинство названий локаций сами по себе не являются популярными 
тегами из социальных сетей. Поэтому в случаях, когда это возможно, необходимо
выполнить некоторое сопоставление:


  \begin{itemize}
      \item \textit{baseball field, basketball court}  $\rightarrow$ \htag{sport}
      \item \textit{ice shelf, forest} $\rightarrow$ \htag{nature}
      \item \textit{wind farm} $\rightarrow \times$ 
  \end{itemize}
  
  
\indent
\indent
Обученная на таких данных модель по окружению,
обнаруженному на пользовательском фото,
сможет подсказать ему подходящий хэштег.



\indent
\indent
Ясно, что полученная модель будет корректно работать лишь для
ограниченного (пусть и большого) домена классов, присутствовавших 
в датасете. Следовательно, необходимо 
обучить её распознавать не входящие в этот домен изображения, чтобы
не пытаться определить их категорию. Кроме того, в случае низкой уверенности
в правильности предсказания так же лучше ничего не делать. 
По мнению автора, предпочтительнее не 
предложить пользователю подходящий хэштег, чем многократно предлагать 
не очень релевантные варианты.
 
   
\indent
\indent
В качестве моделей, извлекающих информацию из изображений,
в работе используются глубокие сверточные
нейронные сети. Данный выбор обосновывается тем, что в последние
годы сверточные сети отлично зарекомендовали себя для решения задач, связанных
с обработкой изображений. Mожно привести в пример самый большой 
и известный
конкурс по классификации изображений \textit{ImageNet}\cite{imagenet},
который проводится ежегодно с 2010 года. При этом, начиная с 2012 года, классические
решения ни разу не побеждали, уступив место нейронным сетям.


\indent
\indent
Научная новизна работы определяется адаптацией датасета \textit{SUN} для решения задачи о структурировании изображений в социальных сетях.
